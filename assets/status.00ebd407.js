import{r as i,i as O}from"./react.7dc093bc.js";import{F as c,u as V,a as k,j as q,R as x,C as u,S as C}from"./index.bfe72ec0.js";import{s as h}from"./styles.module.f478b5d2.js";import{j as d,a as e}from"./index.528827e4.js";import{S as G}from"./index.b7bb13ea.js";import"./lodash.71f9f2ff.js";const{Option:T}=C,X=()=>{const[y]=c.useForm(),[$,S]=i.exports.useState([]),[n,v]=i.exports.useState([]),[p,w]=i.exports.useState(""),[I,L]=i.exports.useState(""),[b,g]=i.exports.useState(!1);V(()=>{A()});async function A(){const{types:t}=await k();S(t||[]),t.length>0&&(y.setFieldsValue({category:t[0]}),f(t[0]))}async function f(t){g(!0);try{w(t);let{date:a,results:s}=await q(t);L(a),v(s),F(t,s),g(!1)}catch{g(!1)}}function F(t,a){for(let s=0;s<a.length;s++){const l=a[s];j(l,t)}}function j(t,a,s){const l=`${a}-${t.title}`,B=document.getElementById(`${l}`);let E=O(B),N=document.getElementById(`${l}-title`);const{xAxis:R,title:D,lines:H,sql:M}=t;N.innerHTML=`
        <span style='display: flex'>
          <span style='font-weight: bold; padding-right: 10px;'>${D}:</span><span>${M}</span>
        </span>
      `,E.setOption({xAxis:{type:"category",data:R},yAxis:{type:"value",name:"s"},tooltip:{trigger:"axis",formatter(r){let o="";return r.forEach((m,W)=>{o+=`<div>${m.marker} ${m.name}:${m.data}</div>`}),o}},series:[{data:H.map(r=>r.toFixed(3)),type:"bar",itemStyle:{normal:{label:{show:!0},color:function(r){var o=["#5470c6","#91cc75","#fac858","#ee6666"];return o[r.dataIndex]}}}}]})}return d("div",{children:[e(c,{form:y,initialValues:{category:p},children:d(x,{gutter:20,children:[e(u,{span:4,children:e(c.Item,{name:"category",label:"Category",children:e(C,{onChange:f,children:$.map((t,a)=>e(T,{value:t,children:t},a))})})}),e(u,{span:6,children:e(c.Item,{label:"Latest",children:d("span",{children:[I," (",n&&n.length>0&&n[0].version,")"]})})})]})}),e(G,{spinning:b,children:e(x,{className:h.allChartWrap,style:{minHeight:"400px"},gutter:10,children:n==null?void 0:n.map(t=>e(u,{span:8,style:{marginBottom:"20px"},children:d("div",{className:h.content,children:[e("div",{className:h.title,id:`${p}-${t.title}-title`}),e("div",{style:{height:"300px",width:"100%"},id:`${p}-${t.title}`})]})},t.title))})})]})};export{X as default};
